{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"dotenv\"","webpack:///external \"puppeteer\"","webpack:///./credentials/mongodb-connect.js","webpack:///./model/User.js","webpack:///external \"mongoose\"","webpack:///external \"@babel/polyfill\"","webpack:///external \"axios\"","webpack:///./utilities/getBasicProfileData.js","webpack:///./utilities/openBrowser.js","webpack:///./utilities/loginAction.js","webpack:///./main.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","mongoose","config","mongoConnectionString","process","env","MONGO_CONNECTION_STRING","connect","useNewUrlParser","useUnifiedTopology","db","connection","UserScheme","Schema","username","String","followedBy","Number","following","fullName","isPrivate","Boolean","isError","totalMediaCount","lastTwelvePhotos","instaAiCaption","commentsDisabled","likedBy","mediaCaption","text","commentCount","takenAtTimestamp","model","getBasicProfileData","page","waitUntil","evaluate","selector","document","querySelector","innerText","jsonStr","console","log","waitFor","parsedJson","JSON","parse","keys","length","user","graphql","is_private","finalResult","bio","biography","edge_followed_by","count","edge_follow","full_name","edge_owner_to_timeline_media","is_verified","edges","map","pic","node","accessibility_caption","comments_disabled","edge_liked_by","edge_media_to_caption","item","edge_media_to_comment","taken_at_timestamp","openBrowser","puppeteer","launch","headless","executablePath","browser","newPage","setViewport","width","height","deviceScaleFactor","loginInstagram","waitForSelector","focus","keyboard","type","INSTA_USERNAME","INSTA_PASSWORD","click","waitForNavigation","dotenv","once","main","User","findOne","$and","$exists","lean","userToCrawl","basicProfileData","profileDataKeys","updateOne","_id","close","exit"],"mappings":"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","file":"bundle.server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"assets\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n","module.exports = require(\"dotenv\");","module.exports = require(\"puppeteer\");","const mongoose = require(\"mongoose\");\nconst dotenv = require(\"dotenv\");\ndotenv.config();\n\nconst mongoConnectionString = process.env.MONGO_CONNECTION_STRING;\nmongoose.connect(mongoConnectionString, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true,\n});\n\nmodule.exports = { db: mongoose.connection, mongoConnectionString };\n","const mongoose = require(\"mongoose\");\nconst Schema = mongoose.Schema;\n\nconst UserScheme = new Schema({\n  username: String,\n  followedBy: Number,\n  following: Number,\n  fullName: String,\n  isPrivate: Boolean,\n  isError: Boolean,\n  totalMediaCount: Number,\n  lastTwelvePhotos: [\n    {\n      instaAiCaption: String,\n      commentsDisabled: Boolean,\n      likedBy: Number,\n      mediaCaption: [\n        {\n          text: String,\n        },\n      ],\n      commentCount: Number,\n      takenAtTimestamp: Number,\n    },\n  ],\n});\n\nmodule.exports = mongoose.model(\"User\", UserScheme);\n","module.exports = require(\"mongoose\");","module.exports = require(\"@babel/polyfill\");","module.exports = require(\"axios\");","import axios from \"axios\";\n\nexport const getBasicProfileData = async (username, page) => {\n  await page.goto(`https://www.instagram.com/${username}/?__a=1`, {\n    waitUntil: \"networkidle2\",\n  });\n  let jsonStr;\n  try {\n    jsonStr = await page.evaluate(\n      (selector) => document.querySelector(selector).innerText,\n      \"body > pre\"\n    );\n  } catch {\n    const tooMuchRequestErr = await page.evaluate((selector) => {\n      return document.querySelector(selector).innerText;\n    }, \"body > div > div.page > div > div > p\");\n\n    if (\n      tooMuchRequestErr === \"Please wait a few minutes before you try again.\"\n    ) {\n      console.log(\"BEKLIYOM...\");\n      await page.waitFor(600000);\n      await getBasicProfileData(username, page);\n    } else {\n      return { isError: true };\n    }\n  }\n\n  const parsedJson = JSON.parse(jsonStr);\n  if (Object.keys(parsedJson).length === 0) {\n    return { isError: true };\n  }\n  const {\n    graphql: { user },\n  } = parsedJson;\n  if (user.is_private) {\n    const finalResult = {\n      bio: user.biography,\n      followedBy: user.edge_followed_by.count,\n      following: user.edge_follow.count,\n      fullName: user.full_name,\n      isPrivate: user.is_private,\n      totalMediaCount: user.edge_owner_to_timeline_media.count,\n    };\n    return finalResult;\n  } else {\n    const finalResult = {\n      bio: user.biography,\n      followedBy: user.edge_followed_by.count,\n      following: user.edge_follow.count,\n      fullName: user.full_name,\n      isPrivate: user.is_private,\n      is_verified: user.is_verified,\n      totalMediaCount: user.edge_owner_to_timeline_media.count,\n      lastTwelvePhotos: user.edge_owner_to_timeline_media.edges.map((pic) => ({\n        instaAiCaption: pic.node.accessibility_caption,\n        commentsDisabled: pic.node.comments_disabled,\n        likedBy: pic.node.edge_liked_by.count,\n        mediaCaption: pic.node.edge_media_to_caption.edges.map((item) => ({\n          text: item.node.text,\n        })),\n        commentCount: pic.node.edge_media_to_comment.count,\n        takenAtTimestamp: pic.node.taken_at_timestamp,\n      })),\n    };\n    return finalResult;\n  }\n};\n","import puppeteer from \"puppeteer\";\n\nexport const openBrowser = async () => {\n  const browser = await puppeteer.launch({\n    headless: false,\n    executablePath:\n      \"/Users/berkelmas/nodeProjects/instagramBot/node_modules/puppeteer/.local-chromium/mac-756035/chrome-mac/Chromium.app/Contents/MacOS/Chromium\",\n  });\n  const page = await browser.newPage();\n\n  await page.setViewport({\n    width: 1600,\n    height: 770,\n    deviceScaleFactor: 1,\n  });\n\n  return { page, browser };\n};\n","import puppeteer from \"puppeteer\";\nconst dotenv = require(\"dotenv\");\ndotenv.config();\n\nexport const loginInstagram = async (page) => {\n  await page.goto(\"https://www.instagram.com\", { waitUntil: \"networkidle2\" });\n  await page.waitForSelector(\n    \"div:nth-child(2) > div:nth-child(1) > label:nth-child(1) > input:nth-child(2)\"\n  );\n  await page.focus(\n    \"div:nth-child(2) > div:nth-child(1) > label:nth-child(1) > input:nth-child(2)\"\n  );\n  await page.keyboard.type(process.env.INSTA_USERNAME);\n  await page.focus(\n    \"div:nth-child(3) > div:nth-child(1) > label:nth-child(1) > input:nth-child(2)\"\n  );\n  await page.keyboard.type(process.env.INSTA_PASSWORD);\n  await page.click(\"button[type='submit']\");\n  await page.waitForNavigation({ waitUntil: \"networkidle2\" });\n  // await page.click(\"button:nth-child(1)\");\n  // await page.waitForNavigation({ waitUntil: \"networkidle2\" });\n};\n","import \"@babel/polyfill\";\nimport { db } from \"./credentials/mongodb-connect\";\nimport User from \"./model/User\";\n\nimport { getBasicProfileData } from \"./utilities/getBasicProfileData\";\nimport dotenv from \"dotenv\";\nimport { openBrowser } from \"./utilities/openBrowser\";\nimport { loginInstagram } from \"./utilities/loginAction\";\ndotenv.config();\n\ndb.once(\"open\", async () => {\n  const main = async () => {\n    const { page, browser } = await openBrowser();\n    await loginInstagram(page);\n    while (true) {\n      const userToCrawl = await User.findOne({\n        $and: [\n          { isPrivate: { $exists: false } },\n          { isError: { $exists: false } },\n        ],\n      }).lean();\n      const basicProfileData = await getBasicProfileData(\n        userToCrawl.username,\n        page\n      );\n      const profileDataKeys = Object.keys(basicProfileData);\n      for (let i = 0; i < profileDataKeys.length; i++) {\n        userToCrawl[profileDataKeys[i]] = basicProfileData[profileDataKeys[i]];\n      }\n      await User.updateOne({ _id: userToCrawl._id }, userToCrawl);\n      await page.waitFor(10000);\n    }\n  };\n  await main();\n  db.close();\n  process.exit();\n});\n"],"sourceRoot":""}